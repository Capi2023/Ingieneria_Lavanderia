{% extends 'base_cliente.html' %}

{% block content %}
<h2>Añadir Detalles al Pedido: {{ pedido.id }}</h2>
<form method="post">
    {% csrf_token %}
    {{ formset.management_form }}
    {% for form in formset %}
        <div class="detalle-pedido">
            {{ form.as_p }}
        </div>
    {% endfor %}
    <button type="button" id="add-more" class="btn btn-primary">Añadir más ropa</button>
    <button type="submit" class="btn btn-primary">Guardar Detalles</button>
</form>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const addButton = document.getElementById('add-more');
        addButton.addEventListener('click', function(e) {
            e.preventDefault();
            const totalForms = document.getElementById('id_form-TOTAL_FORMS');
            const formCount = parseInt(totalForms.value, 10);
            let newForm = document.querySelector('.detalle-pedido').cloneNode(true);
            newForm.innerHTML = newForm.innerHTML.replace(/-0-/g, `-${formCount}-`).replace(/_0_/g, `_${formCount}_`);
            document.getElementById('formset-container').appendChild(newForm);
            totalForms.value = formCount + 1;
        });
    });
</script>
{% endblock %}
